### Рекомендательная система для подбора музыкальных треков


### **Запуск**
- Клонировать репозиторий
- Скачать [модель и данные](https://huggingface.co/EvgeniyKirr/music_rec_sys_data/tree/main) и разместить их на путях
```
music_rec_sys/app/model.pt
music_rec_sys/db/tracks.tsv.gz
```
- Поднять контейнеры
```
docker-compose -f compose.yaml up -d
```
- Скопировать необходимые музыкальные треки в папку **playlist**
- Запустить контейнер для рекомендации
```
docker start -i app
```

### **Принцип действия**
Каждая песня из папки **playlist** режется на 6-ти секундные отрезки. По ним строится форма волны, спектрограмма и спектральный центроид в разные каналы изображения.  
Эти отрезки подаются в модель, которая была обучена на классификации музыкальных треков по жанрам.  
На этапе инференса последний слой заменяется заглушкой, поэтому на выходе получается вектор фиксированной длинны.  
Полученные векторы усредняются в один. После чего идет поиск ближайших векторов из базы данных.  
Пример изображения отрезка.  
![](https://github.com/EvgeniyKirr/music_rec_sys/raw/main/img_example.png?raw=true)

### **Архитектура нейронной сети**
Представляет собой стандартный ResNet34 с парой изменений.
- Добавлен дополнительный полносвязный слой для регулирования размера вектора
- Изменена последовательность слоев в Residual Block на BatchNorm > Relu > Conv3x3
